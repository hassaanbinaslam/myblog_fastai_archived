---
keywords: fastai
description: Some useful notes on AWS CloudFormation template sections, intrinsic functions, and other tips.
title: AWS CloudFormation Template, Functions, and Commands
toc: true 
badges: false
comments: true
categories: [aws]
image: images/2022-02-28-aws-cloudformtion.png
keyword: [aws, cloudformation, template, intrinsic functions]
nb_path: _notebooks/2022-02-28-aws-cloudformation-template.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022-02-28-aws-cloudformation-template.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="About">About<a class="anchor-link" href="#About"> </a></h1><p>This post is a collection of useful notes on various sections of AWS CloudFormation template, and intrinsic functions. Knowledge about them is often tested in AWS certifications. 
For more details on this subject refer to its user guide (<a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/Welcome.html">https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/Welcome.html</a>)</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Template-Anatomy">Template Anatomy<a class="anchor-link" href="#Template-Anatomy"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following is an example of AWS CloudFormation template and its sections in YAML format. There is no sequence to writing these sections besides that if there is a <strong>Description</strong> section then it must be put after <strong>AWSTemplateFormatVersion</strong>.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<div class="highlight"><pre><span></span><span class="nt">AWSTemplateFormatVersion</span><span class="p">:</span> <span class="s">&quot;version</span><span class="nv"> </span><span class="s">date&quot;</span>

<span class="nt">Description</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">String</span>

<span class="nt">Metadata</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">template metadata</span>

<span class="nt">Parameters</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">set of parameters</span>

<span class="nt">Rules</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">set of rules</span>

<span class="nt">Mappings</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">set of mappings</span>

<span class="nt">Conditions</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">set of conditions</span>

<span class="nt">Transform</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">set of transforms</span>

<span class="nt">Resources</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">set of resources</span>

<span class="nt">Outputs</span><span class="p">:</span>
  <span class="l l-Scalar l-Scalar-Plain">set of outputs</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Template-Sections">Template Sections<a class="anchor-link" href="#Template-Sections"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="AWSTemplateFormatVersion-(optional)"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/format-version-structure.html">AWSTemplateFormatVersion (optional)</a><a class="anchor-link" href="#AWSTemplateFormatVersion-(optional)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The AWS CloudFormation template version that the template conforms to.</p>
<h3 id="Syntax">Syntax<a class="anchor-link" href="#Syntax"> </a></h3><div class="highlight"><pre><span></span><span class="nt">AWSTemplateFormatVersion</span><span class="p">:</span> <span class="s">&quot;2010-09-09&quot;</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Description-(optional)"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/template-description-structure.html">Description (optional)</a><a class="anchor-link" href="#Description-(optional)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>A text string that describes the template. This section must always follow the template format version section.</p>
<h3 id="Syntax">Syntax<a class="anchor-link" href="#Syntax"> </a></h3><div class="highlight"><pre><span></span><span class="nt">Description</span><span class="p">:</span> <span class="p p-Indicator">&gt;</span>
  <span class="no">Here are some</span>
  <span class="no">details about</span>
  <span class="no">the template.</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Metadata-(optional)"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/metadata-section-structure.html">Metadata (optional)</a><a class="anchor-link" href="#Metadata-(optional)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Objects that provide additional information about the template.</p>
<ul>
<li>Difference between <strong>Metadata</strong> and <strong>Description</strong> is that some cloudformation features can refer to the objects that are defined in Metadata section. For example, you can use a metadata key <code>AWS::CloudFormation::Interface</code> to define how parameters are grouped and sorted on AWS cloudformation console. By default, cloudformation console alphbetically sorts the parameters by their logical ID.</li>
<li>AWS strongly recommends not to use this section for storing sensitive information such as passwords or secrets.</li>
</ul>
<h3 id="Syntax">Syntax<a class="anchor-link" href="#Syntax"> </a></h3><div class="highlight"><pre><span></span><span class="nt">Metadata</span><span class="p">:</span>
  <span class="nt">Instances</span><span class="p">:</span>
    <span class="nt">Description</span><span class="p">:</span> <span class="s">&quot;Information</span><span class="nv"> </span><span class="s">about</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">instances&quot;</span>
  <span class="nt">Databases</span><span class="p">:</span> 
    <span class="nt">Description</span><span class="p">:</span> <span class="s">&quot;Information</span><span class="nv"> </span><span class="s">about</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">databases&quot;</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Parameters-(optional)"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/parameters-section-structure.html">Parameters (optional)</a><a class="anchor-link" href="#Parameters-(optional)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Parameters enable you to input custom values to your template each time you create or update a stack. You can refer to parameters from the <strong>Resources</strong> and <strong>Outputs</strong> sections of the template using <strong>Ref</strong> intrinsic function.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>CloudFormation currently supports the following parameter types</p>
<ul>
<li>String – A literal string</li>
<li>Number – An integer or float</li>
<li><code>List&lt;Number&gt;</code> – An array of integers or floats</li>
<li>CommaDelimitedList – An array of literal strings that are separated by commas</li>
<li><code>AWS::EC2::KeyPair::KeyName</code> – An Amazon EC2 key pair name</li>
<li><code>AWS::EC2::SecurityGroup::Id</code> – A security group ID</li>
<li><code>AWS::EC2::Subnet::Id</code> – A subnet ID</li>
<li><code>AWS::EC2::VPC::Id</code> – A VPC ID</li>
<li><code>List&lt;AWS::EC2::VPC::Id&gt;</code> – An array of VPC IDs</li>
<li><code>List&lt;AWS::EC2::SecurityGroup::Id&gt;</code> – An array of security group IDs</li>
<li><code>List&lt;AWS::EC2::Subnet::Id&gt;</code> – An array of subnet IDs</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Syntax">Syntax<a class="anchor-link" href="#Syntax"> </a></h3><p>The following example declares a parameter named <code>InstanceTypeParameter</code>. This parameter lets you specify the Amazon EC2 instance type for the stack to use when you create or update the stack.</p>
<p>Note that <code>InstanceTypeParameter</code> has a default value of <code>t2.micro</code>. This is the value that AWS CloudFormation will use to provision the stack unless another value is provided.</p>
<div class="highlight"><pre><span></span><span class="nt">Parameters</span><span class="p">:</span>
  <span class="nt">InstanceTypeParameter</span><span class="p">:</span>
    <span class="nt">Type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">String</span>
    <span class="nt">Default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">t2.micro</span>
    <span class="nt">AllowedValues</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">t2.micro</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">m1.small</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">m1.large</span>
    <span class="nt">Description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Enter t2.micro, m1.small, or m1.large. Default is t2.micro.</span>
</pre></div>
<h4 id="Referencing-a-parameter-in-template-(Ref-function)"><strong>Referencing a parameter in template (<code>Ref function</code>)</strong><a class="anchor-link" href="#Referencing-a-parameter-in-template-(Ref-function)"> </a></h4><p>In the following example, the <code>InstanceType</code> property of the EC2 instance resource references the <code>InstanceTypeParameter</code> parameter value.</p>
<div class="highlight"><pre><span></span><span class="nt">Ec2Instance</span><span class="p">:</span>
  <span class="nt">Type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">AWS::EC2::Instance</span>
  <span class="nt">Properties</span><span class="p">:</span>
    <span class="nt">InstanceType</span><span class="p">:</span>
      <span class="nt">Ref</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">InstanceTypeParameter</span>
    <span class="nt">ImageId</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ami-0ff8a91507f77f867</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Rules-(optional)"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/rules-section-structure.html">Rules (optional)</a><a class="anchor-link" href="#Rules-(optional)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Validates a parameter or a combination of parameters that are passed to a template during a stack creation or stack update.</p>
<p>You can use the following rule-specific intrinsic functions to define rule conditions and assertions:</p>
<ul>
<li><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-rules.html#fn-and">Fn::And</a></li>
<li><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-rules.html#fn-Contains">Fn::Contains</a></li>
<li><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-rules.html#fn-EachMemberEquals">Fn::EachMemberEquals</a></li>
<li><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-rules.html#fn-EachMemberIn">Fn::EachMemberIn</a></li>
<li><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-rules.html#fn-equals">Fn::Equals</a></li>
<li><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-rules.html#fn-if">Fn::If</a></li>
<li><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-rules.html#fn-not">Fn::Not</a></li>
<li><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-rules.html#fn-or">Fn::Or</a></li>
<li><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-rules.html#fn-refall">Fn::RefAll</a></li>
<li><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-rules.html#fn-valueof">Fn::ValueOf</a></li>
<li><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-rules.html#fn-valueofall">Fn::ValueOfAll</a></li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Syntax">Syntax<a class="anchor-link" href="#Syntax"> </a></h3><p>In the following example, the rule checks the value of the <code>InstanceType</code> parameter. The user must specify <code>a1.medium</code>, if the value of the environment parameter is <code>test</code>.</p>
<div class="highlight"><pre><span></span><span class="nt">Rules</span><span class="p">:</span>
  <span class="nt">testInstanceType</span><span class="p">:</span>
    <span class="nt">RuleCondition</span><span class="p">:</span> <span class="kt">!Equals</span> 
      <span class="p p-Indicator">-</span> <span class="kt">!Ref</span> <span class="l l-Scalar l-Scalar-Plain">Environment</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">test</span>
    <span class="nt">Assertions</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="nt">Assert</span><span class="p">:</span>
          <span class="s">&#39;Fn::Contains&#39;</span><span class="p p-Indicator">:</span>
            <span class="p p-Indicator">-</span> <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">a1.medium</span>
            <span class="p p-Indicator">-</span> <span class="kt">!Ref</span> <span class="l l-Scalar l-Scalar-Plain">InstanceType</span>
        <span class="nt">AssertDescription</span><span class="p">:</span> <span class="s">&#39;For</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">test</span><span class="nv"> </span><span class="s">environment,</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">instance</span><span class="nv"> </span><span class="s">type</span><span class="nv"> </span><span class="s">must</span><span class="nv"> </span><span class="s">be</span><span class="nv"> </span><span class="s">a1.medium&#39;</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Mappings-(optional)"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/mappings-section-structure.html">Mappings (optional)</a><a class="anchor-link" href="#Mappings-(optional)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The optional Mappings section matches a key to a corresponding set of named values similar to a lookup table. For example, if you want to set values based on a region, you can create a mapping that uses the region name as a key and contains the values you want to specify for each specific region. You use the <code>Fn::FindInMap</code> intrinsic function in the <strong>Resources</strong> and <strong>Outputs</strong> to retrieve values in a map. Note that you can't include parameters, pseudo parameters, or intrinsic functions in the Mappings section.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Fn::FindInMap"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-findinmap.html">Fn::FindInMap</a><a class="anchor-link" href="#Fn::FindInMap"> </a></h4><p>The intrinsic function <code>Fn::FindInMap</code> returns the value corresponding to keys in a two-level map that's declared in the Mappings section.</p>
<p>Syntax for the short form:</p>
<div class="highlight"><pre><span></span><span class="kt">!FindInMap</span> <span class="p p-Indicator">[</span> <span class="nv">MapName</span><span class="p p-Indicator">,</span> <span class="nv">TopLevelKey</span><span class="p p-Indicator">,</span> <span class="nv">SecondLevelKey</span> <span class="p p-Indicator">]</span>
</pre></div>
<p><strong>Parameters</strong></p>
<ul>
<li>MapName<ul>
<li>The logical name of a mapping declared in the Mappings section that contains the keys and values.</li>
</ul>
</li>
<li>TopLevelKey<ul>
<li>The top-level key name. Its value is a list of key-value pairs.</li>
</ul>
</li>
<li>SecondLevelKey<ul>
<li>The second-level key name, which is set to one of the keys from the list assigned to TopLevelKey.</li>
</ul>
</li>
</ul>
<p>A more concrete example</p>
<div class="highlight"><pre><span></span><span class="nt">Mappings</span><span class="p">:</span> 
  <span class="nt">RegionMap</span><span class="p">:</span> 
    <span class="nt">us-east-1</span><span class="p">:</span> 
      <span class="nt">HVM64</span><span class="p">:</span> <span class="s">&quot;ami-0ff8a91507f77f867&quot;</span>
      <span class="nt">HVMG2</span><span class="p">:</span> <span class="s">&quot;ami-0a584ac55a7631c0c&quot;</span>
<span class="nt">Resources</span><span class="p">:</span> 
  <span class="nt">myEC2Instance</span><span class="p">:</span> 
    <span class="nt">Type</span><span class="p">:</span> <span class="s">&quot;AWS::EC2::Instance&quot;</span>
    <span class="nt">Properties</span><span class="p">:</span> 
      <span class="nt">ImageId</span><span class="p">:</span> <span class="kt">!FindInMap</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">RegionMap</span>
        <span class="p p-Indicator">-</span> <span class="kt">!Ref</span> <span class="s">&#39;AWS::Region&#39;</span> <span class="c1"># us-east-1</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">HVM64</span>
      <span class="nt">InstanceType</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">m1.small</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Conditions-(optional)"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/conditions-section-structure.html">Conditions (optional)</a><a class="anchor-link" href="#Conditions-(optional)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Conditions that control whether certain resources are created or whether certain resource properties are assigned a value during stack creation or update. For example, you could conditionally create a resource that depends on whether the stack is for a production or test environment.</p>
<p>Conditions are defined in <code>Conditions</code> section, and are then applied in following sections.</p>
<ul>
<li>Parameters</li>
<li>Resources</li>
<li>Outputs</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You can use following intrinsic functions to define your conditions</p>
<ul>
<li>Fn::And</li>
<li>Fn::Equals</li>
<li>Fn::If</li>
<li>Fn::Not</li>
<li>Fn::Or</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Syntax">Syntax<a class="anchor-link" href="#Syntax"> </a></h3><div class="highlight"><pre><span></span><span class="nt">Conditions</span><span class="p">:</span>
  <span class="nt">Logical ID</span><span class="p">:</span>
    <span class="l l-Scalar l-Scalar-Plain">Intrinsic function</span>
</pre></div>
<p>A more concrete example</p>
<div class="highlight"><pre><span></span><span class="nt">AWSTemplateFormatVersion</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">2010-09-09</span>
<span class="nt">Parameters</span><span class="p">:</span>
  <span class="nt">EnvType</span><span class="p">:</span>
    <span class="nt">Description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Environment type.</span>
    <span class="nt">Default</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">test</span>
    <span class="nt">Type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">String</span>
    <span class="nt">AllowedValues</span><span class="p">:</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">prod</span>
      <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">test</span>
    <span class="nt">ConstraintDescription</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">must specify prod or test.</span>
<span class="nt">Conditions</span><span class="p">:</span>
  <span class="nt">CreateProdResources</span><span class="p">:</span> <span class="kt">!Equals</span> 
    <span class="p p-Indicator">-</span> <span class="kt">!Ref</span> <span class="l l-Scalar l-Scalar-Plain">EnvType</span>
    <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">prod</span>
<span class="nt">Resources</span><span class="p">:</span>
  <span class="nt">EC2Instance</span><span class="p">:</span>
    <span class="nt">Type</span><span class="p">:</span> <span class="s">&#39;AWS::EC2::Instance&#39;</span>
    <span class="nt">Properties</span><span class="p">:</span>
      <span class="nt">ImageId</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">ami-0ff8a91507f77f867</span>
  <span class="nt">MountPoint</span><span class="p">:</span>
    <span class="nt">Type</span><span class="p">:</span> <span class="s">&#39;AWS::EC2::VolumeAttachment&#39;</span>
    <span class="nt">Condition</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CreateProdResources</span>
    <span class="nt">Properties</span><span class="p">:</span>
      <span class="nt">InstanceId</span><span class="p">:</span> <span class="kt">!Ref</span> <span class="l l-Scalar l-Scalar-Plain">EC2Instance</span>
      <span class="nt">VolumeId</span><span class="p">:</span> <span class="kt">!Ref</span> <span class="l l-Scalar l-Scalar-Plain">NewVolume</span>
      <span class="nt">Device</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">/dev/sdh</span>
  <span class="nt">NewVolume</span><span class="p">:</span>
    <span class="nt">Type</span><span class="p">:</span> <span class="s">&#39;AWS::EC2::Volume&#39;</span>
    <span class="nt">Condition</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CreateProdResources</span>
    <span class="nt">Properties</span><span class="p">:</span>
      <span class="nt">Size</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">100</span>
      <span class="nt">AvailabilityZone</span><span class="p">:</span> <span class="kt">!GetAtt</span> 
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">EC2Instance</span>
        <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">AvailabilityZone</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Difference-between-Rules-and-Conditions-usage?">Difference between Rules and Conditions usage?<a class="anchor-link" href="#Difference-between-Rules-and-Conditions-usage?"> </a></h3><ul>
<li>Rules are used to evaluate the input given by the user in Parameters</li>
<li>Conditions turn come after all rules have been evaluated</li>
<li>Conditions are not limited to Parameters and can also work with Resources and Outputs</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Transform-(optional)"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/transform-section-structure.html">Transform (optional)</a><a class="anchor-link" href="#Transform-(optional)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For <a href="https://docs.aws.amazon.com/lambda/latest/dg/deploying-lambda-apps.html">serverless applications</a> (also referred to as Lambda-based applications), specifies the version of the <a href="https://github.com/awslabs/serverless-application-specification">AWS Serverless Application Model (AWS SAM)</a> to use. When you specify a transform, you can use AWS SAM syntax to declare resources in your template. The model defines the syntax that you can use and how it&#39;s processed.</p>
<p>You can also use <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/create-reusable-transform-function-snippets-and-add-to-your-template-with-aws-include-transform.html">AWS::Include</a> transforms to work with template snippets that are stored separately from the main AWS CloudFormation template. You can store your snippet files in an Amazon S3 bucket and then reuse the functions across multiple templates.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Syntax">Syntax<a class="anchor-link" href="#Syntax"> </a></h3><div class="highlight"><pre><span></span><span class="nt">Transform</span><span class="p">:</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">MyMacro</span>
  <span class="p p-Indicator">-</span> <span class="s">&#39;AWS::Serverless&#39;</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="AWS::Include-transform"><strong>AWS::Include transform</strong><a class="anchor-link" href="#AWS::Include-transform"> </a></h4><p>Use the AWS::Include transform, which is a macro hosted by AWS CloudFormation, to insert boilerplate content into your templates. The <code>AWS::Include</code> transform lets you create a reference to a template snippet in an Amazon S3 bucket. The <code>AWS::Include</code> function behaves similarly to an include, copy, or import directive in programming languages.</p>
<h5 id="Example">Example<a class="anchor-link" href="#Example"> </a></h5><div class="highlight"><pre><span></span><span class="nt">Transform</span><span class="p">:</span>
  <span class="nt">Name</span><span class="p">:</span> <span class="s">&#39;AWS::Include&#39;</span>
  <span class="nt">Parameters</span><span class="p">:</span>
    <span class="nt">Location</span><span class="p">:</span> <span class="s">&#39;s3://MyAmazonS3BucketName/MyFileName.yaml&#39;</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Resources-(required)"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/resources-section-structure.html">Resources (required)</a><a class="anchor-link" href="#Resources-(required)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Specifies the stack resources and their properties, such as an Amazon Elastic Compute Cloud instance or an Amazon Simple Storage Service bucket. You can refer to resources in the Resources and Outputs sections of the template.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Syntax">Syntax<a class="anchor-link" href="#Syntax"> </a></h3><div class="highlight"><pre><span></span><span class="nt">Resources</span><span class="p">:</span>
  <span class="nt">Logical ID</span><span class="p">:</span>
    <span class="nt">Type</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Resource type</span>
    <span class="nt">Properties</span><span class="p">:</span>
      <span class="l l-Scalar l-Scalar-Plain">Set of properties</span>
</pre></div>
<p>A more concrete example</p>
<div class="highlight"><pre><span></span><span class="nt">Resources</span><span class="p">:</span>
  <span class="nt">MyEC2Instance</span><span class="p">:</span>
    <span class="nt">Type</span><span class="p">:</span> <span class="s">&quot;AWS::EC2::Instance&quot;</span>
    <span class="nt">Properties</span><span class="p">:</span>
      <span class="nt">ImageId</span><span class="p">:</span> <span class="s">&quot;ami-0ff8a91507f77f867&quot;</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Outputs-(optional)"><a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/outputs-section-structure.html">Outputs (optional)</a><a class="anchor-link" href="#Outputs-(optional)"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The optional Outputs section declares output values that you can <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-importvalue.html">import into other stacks</a> (to <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/walkthrough-crossstackref.html">create cross-stack references</a>), return in response (to describe stack calls), or <a href="https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-console-view-stack-data-resources.html">view on the AWS CloudFormation console</a>. For example, you can output the S3 bucket name from a stack to make the bucket easier to find.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notes</p>
<ul>
<li>You can declare a maximum of 200 outputs in a template.</li>
<li>AWS strongly recommend you don't use this section to output sensitive information, such as passwords or secrets</li>
<li>Output values are available after the stack operation is complete. Stack output values aren't available when a stack status is in any of the IN_PROGRESS status.</li>
<li>AWS also does not recommend establishing dependencies between a service runtime and the stack output value because output values might not be available at all times.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Syntax">Syntax<a class="anchor-link" href="#Syntax"> </a></h3><div class="highlight"><pre><span></span><span class="nt">Outputs</span><span class="p">:</span>
  <span class="nt">Logical ID</span><span class="p">:</span>
    <span class="nt">Description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Information about the value</span>
    <span class="nt">Value</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Value to return</span>
    <span class="nt">Export</span><span class="p">:</span>
      <span class="nt">Name</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">Name of resource to export</span>
</pre></div>
<p>A more concrete example where certain values are shown as output at the end of stack creation.</p>
<div class="highlight"><pre><span></span><span class="nt">Outputs</span><span class="p">:</span>
  <span class="nt">BackupLoadBalancerDNSName</span><span class="p">:</span>
    <span class="nt">Description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The DNSName of the backup load balancer</span>
    <span class="nt">Value</span><span class="p">:</span> <span class="kt">!GetAtt</span> <span class="l l-Scalar l-Scalar-Plain">BackupLoadBalancer.DNSName</span>
    <span class="nt">Condition</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">CreateProdResources</span>
  <span class="nt">InstanceID</span><span class="p">:</span>
    <span class="nt">Description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The Instance ID</span>
    <span class="nt">Value</span><span class="p">:</span> <span class="kt">!Ref</span> <span class="l l-Scalar l-Scalar-Plain">EC2Instance</span>
</pre></div>
<p>For Cross-Stack output use <strong>Export</strong> tag. Values outputed with "Export" tag can be imported in other stacks "in the same region". Then, use the <code>Fn::ImportValue</code> intrinsic function to import the value in another stack "in the same region".</p>
<div class="highlight"><pre><span></span><span class="nt">Outputs</span><span class="p">:</span>
  <span class="nt">StackVPC</span><span class="p">:</span>
    <span class="nt">Description</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">The ID of the VPC</span>
    <span class="nt">Value</span><span class="p">:</span> <span class="kt">!Ref</span> <span class="l l-Scalar l-Scalar-Plain">MyVPC</span>
    <span class="nt">Export</span><span class="p">:</span>
      <span class="nt">Name</span><span class="p">:</span> <span class="kt">!Sub</span> <span class="s">&quot;${AWS::StackName}-VPCID&quot;</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Some-other-important-Intrinsic-Functions">Some other important Intrinsic Functions<a class="anchor-link" href="#Some-other-important-Intrinsic-Functions"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fn::GetAtt">Fn::GetAtt<a class="anchor-link" href="#Fn::GetAtt"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The <code>Fn::GetAtt</code> intrinsic function returns the value of an attribute from a resource in the template.</p>
<h3 id="Syntax">Syntax<a class="anchor-link" href="#Syntax"> </a></h3><p><code>!GetAtt logicalNameOfResource.attributeName</code></p>
<ul>
<li>logicalNameOfResource<ul>
<li>The logical name (also called logical ID) of the resource that contains the attribute that you want.</li>
</ul>
</li>
<li>attributeName<ul>
<li>The name of the resource-specific attribute whose value you want. See the resource's reference page for details about the attributes available for that resource type.</li>
</ul>
</li>
<li>Return value<ul>
<li>The attribute value.</li>
</ul>
</li>
</ul>
<p>A more concrete example</p>
<p><code>!GetAtt myELB.DNSName</code></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notes:</p>
<ul>
<li>For the <code>Fn::GetAtt</code> logical resource name, you can't use functions. You must specify a string that's a resource's logical ID.</li>
<li>For the <code>Fn::GetAtt</code> attribute name, you can use the <code>Ref function</code>.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fn::ImportValue">Fn::ImportValue<a class="anchor-link" href="#Fn::ImportValue"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The intrinsic function <code>Fn::ImportValue</code> returns the value of an output exported by another stack. You typically use this function to create cross-stack references.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Notes:</p>
<ul>
<li>For each AWS account, Export names must be unique within a region.</li>
<li>You can't create cross-stack references across regions. You can use the intrinsic function <code>Fn::ImportValue</code> to import only values that have been exported within the same region.</li>
<li>You can't delete a stack if another stack references one of its outputs.</li>
<li>You can't modify or remove an output value that is referenced by another stack.</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Syntax">Syntax<a class="anchor-link" href="#Syntax"> </a></h3><p><code>!ImportValue sharedValueToImport</code></p>
<p>A more concrete example.</p>
<div class="highlight"><pre><span></span><span class="l l-Scalar l-Scalar-Plain">Fn::ImportValue</span><span class="p p-Indicator">:</span>
  <span class="kt">!Sub</span> <span class="s">&quot;${NetworkStackName}-SecurityGroupID&quot;</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Fn::Sub">Fn::Sub<a class="anchor-link" href="#Fn::Sub"> </a></h2><p>The intrinsic function <code>Fn::Sub</code> substitutes variables in an input string with values that you specify. In your templates, you can use this function to construct commands or outputs that include values that aren't available until you create or update a stack.</p>
<h3 id="Syntax">Syntax<a class="anchor-link" href="#Syntax"> </a></h3><div class="highlight"><pre><span></span><span class="kt">!Sub</span>
  <span class="p p-Indicator">-</span> <span class="l l-Scalar l-Scalar-Plain">String</span>
  <span class="p p-Indicator">-</span> <span class="nt">VarName</span><span class="p">:</span> <span class="l l-Scalar l-Scalar-Plain">VarValue</span>
</pre></div>
<h4 id="Parameters">Parameters<a class="anchor-link" href="#Parameters"> </a></h4><ul>
<li>String<ul>
<li>A string with variables that AWS CloudFormation substitutes with their associated values at runtime. Write variables as <code>${MyVarName}</code>. Variables can be template parameter names, resource logical IDs, resource attributes, or a variable in a key-value map.</li>
</ul>
</li>
<li>VarName<ul>
<li>The name of a variable that you included in the <code>String</code> parameter.</li>
</ul>
</li>
<li>VarValue<ul>
<li>The value that CloudFormation substitutes for the associated variable name at runtime.</li>
</ul>
</li>
</ul>
<p>A more concrete example. The following example uses a mapping to substitute the <code>${Domain}</code> variable with the resulting value from the <code>Ref</code> function.</p>
<div class="highlight"><pre><span></span><span class="nt">Name</span><span class="p">:</span> <span class="kt">!Sub</span> 
  <span class="p p-Indicator">-</span> <span class="s">&#39;www.${Domain}&#39;</span>
  <span class="p p-Indicator">-</span> <span class="nt">Domain</span><span class="p">:</span> <span class="kt">!Ref</span> <span class="l l-Scalar l-Scalar-Plain">RootDomainName</span>
</pre></div>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Important-CloudFormation-CLI-Commands">Important CloudFormation CLI Commands<a class="anchor-link" href="#Important-CloudFormation-CLI-Commands"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Package a template using <code>aws cloudformation package</code> command</li>
<li>Validate a CloudFormation template using <code>aws cloudformation validate-template</code> command</li>
<li>Deploy a template using the <code>aws cloudformation deploy</code> command</li>
</ul>

</div>
</div>
</div>
</div>
 

